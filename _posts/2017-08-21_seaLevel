---
title: "Machine Learning: The Prediction on Sea Level Variation"
date: 2017-01-28
excerpt: "Since the dataset was unbalanced, the Logistic Regression classifier was implemented by both of undersampling and oversampling datasets to detect fraudulent transactions."
mathjax: "true"
---
## 1 Introduction
 
## 2 Data  

<img src="{{ site.url }}{{ site.baseurl }}/images/ml_creditcard/1_1.png" alt="linearly separable data">

Relevant Python code block:
```python
import matplotlib.pyplot as plt
import pandas as pd

def run(path_read_data, path_save_plot):
    # read data    
    data = pd.read_csv("data/creditcard.csv")
    # check dataset intuitively
    nlegit = len(data[data.Class == 0])
    nfraud = len(data[data.Class == 1])
    # plot
    fig = plt.figure(dpi = 120)
    ax = fig.subplots()
    ax.pie([nlegit, nfraud], explode = (0, 0.1), colors = ["green", "orange"], labels = ('Normal Transactions','Fraudulent Transactions'), autopct='%0.3f%%', shadow=False, startangle=135)
    ax.axis('equal')
    plt.show()
    fig.savefig("plot/1_1.png")    
    return data
```

## 3 Methodology

### 3.1 Raw Dataset
With considering the cost of computation, the IRS of 10 was selected for Logistic Regression model and the confusion matrix showed that the recall value is 0.62. 

<img src="{{ site.url }}{{ site.baseurl }}/images/ml_creditcard/2_cm_raw.png" alt="linearly separable data">

Relevant Python libraries:
```python
from sklearn.cross_validation import KFold
from sklearn.linear_model import LogisticRegression
from sklearn.metrics import recall_score 
from sklearn.metrics import confusion_matrix
```

### 3.2 Undersampling Dataset
To improve the results, the number of legitimate transactions was undersampled in the trainning dataset. Then the number of legitimate transactions is equal to the number of fraudulent transactions. After parameter optimization, the Logistic Regression was built by undersampling training dataset, and applied to the original test dataset. From the confusion matrix showed in the following figure, the value of recall was enhanced to 0.92. However, the value of the False Positive was pretty large. 

<img src="{{ site.url }}{{ site.baseurl }}/images/ml_creditcard/2_cm_uds.png" alt="linearly separable data">


### 3.3 Oversampling Dataset

<img src="{{ site.url }}{{ site.baseurl }}/images/ml_creditcard/2_cm_os.png" alt="linearly separable data">



## 4.Conclusion and Discussion
