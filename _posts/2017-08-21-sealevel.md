---
title: " Machine Learning: The Prediction of Sea Level Variation with considering tidal constituents "
date: 2018-07-21
excerpt: "The goal of this project is to compare the sea level prediction performance from real observation and thermotical tidal model."
mathjax: "true"
---

## 1 Introduction
Rising sea level, originated from global climate change, has led to increasing number of inhabitants in the coastal regions and islands exposed to catastrophic damages. Hence, monitoring and understanding the physical processes of sea level variation and its rise are of great significance, especially for the population living in the coastal regions. The goal of this project is to compare the sea level prediction performance from real observation and thermotical tidal model.

## 2 GPS Dataset
To assess performance of predictive models, two adjacent GPS-R sites of ‘RPT5’ and ‘RPT6’ 38 m apart at Robinson Point are selected for this study. The two collocated GPS-R sea level data spans are 8 years, and with common atmosphere (troposphere and ionosphere), sea state (wind speed and wave height), tides, ocean dynamics, and others, they are suited to be used as a robust error estimate.

<img src="{{ site.url }}{{ site.baseurl }}/images/ml_sealevel/2_1.png" alt="linearly separable data">

## 3. Sea Level Derivation
A single geodetic quality GPS receiver with open view of water can act as a “tide gauge”. In this section, a flowchart of GPS-R sea level derivation is illustrated in the following figure (Larson et al., 2013). Since different reflecting surface such as sea water, snow, and ice can create different interference patterns, the mask generated by azimuth and elevation angle could ensure that all the reflected signals are from the sea surface. Then a low-order polynomial is used as background model to remove the overall trend. In the end, the sea level variations are calculated by the Lomb Scargle Periodograms (LSP) with considering the EM bias correction.

<img src="{{ site.url }}{{ site.baseurl }}/images/ml_sealevel/3_1.png" alt="linearly separable data">

## 4 Feature Engineer and Regression Model
The sea level variation is consisting of long-term trend, tides and other factors (e.g. thermal expansion, salinity variation). Tides are the rise and fall of sea levels caused by the combined effects of the gravitational forces exerted by the Moon and the Sun and the rotation of Earth. In this project, the tidal constituents are calculated from real observations of two neighboring GPS stations using the “T_TIDE” package that is widely utilized by oceanographers (Pawlowicz et al., 2002). As a comparison, the theorical tidal constituents from ‘TPXO’ are also used for feature engineer. The following figure shows, as it should be, that the excellent agreement between the two collocated GPS sites, is better than the agreement between GPS-derived sea levels and ‘TPXO’ tidal model.
<img src="{{ site.url }}{{ site.baseurl }}/images/ml_sealevel/4_1.png" alt="linearly separable data">

This project aims at assessing the performance between real observation and theoretical model. So only one regression model of XGBoost is selected, which is an implementation of graident boosting machines. It considers regularization that can reducing overfitting and always has good performance in practice. When the depth of decision tree is set to 5, the error is minimized.
```python
from xgboost import XGBRegressor
params = [1,2,3,4,5,6]
errors = []
for param in params:
    clf = XGBRegressor(max_depth=param)
    error = np.sqrt(-cross_val_score(clf, X_train, y_train, cv=10, scoring='neg_mean_squared_error'))
    errors.append(np.mean(error))
```

## 5 Results and discussion
When the theoretical tidal model and real observation are used for feature engineer, the Root-Mean Square (RMS) error are 7.3 cm to 3.4 cm, respectively. This outstanding difference shows that the real observation is better for the feature engineer, but the real measurements are usually unavailable for predictions. Therefore, an enhanced tidal model is critical to improve the prediction accuracy.

<img src="{{ site.url }}{{ site.baseurl }}/images/ml_sealevel/5_1.png" alt="linearly separable data">

For further investigation, the tidal constituents with absolute differences larger than 1 cm are analyzed. As the largest constituent, the “principal lunar semi-diurnal” of M_2 has the amplitude larger than 30 cm. The following figure shows that their phase lags were very close but the amplitude of tidal constituents are underestimated in the GPS-R derived sea levels. And the “lunar diurnal constituent” of K_1 is the second largest tidal constituent whose amplitude is also underestimated. The same conclusions are made from other tidal constituents.

<img src="{{ site.url }}{{ site.baseurl }}/images/ml_sealevel/5_2.png" alt="linearly separable data">

## 6 Conclusion
We concluded that the predicted sea level from theoretical tidal model is worse than the prediction from real observation, because the underestimation of tidal amplitude from TPXO. Therefore, the improvement of tidal amplitude accuracy is critical for sea level predictions. The remaining errors are possibly resulting from tropospheric refraction, other media corrections, or distorted SNR time series, and future study is warranted.

## Reference
+ Larson, K. M., J. S. Löfgren and R. Haas (2013). "Coastal sea level measurements using a single geodetic GPS receiver." Advances in Space Research 51(8): 1301-1310.
+ Pawlowicz, R., B. Beardsley and S. Lentz (2002). "Classical tidal harmonic analysis including error estimates in MATLAB using T_TIDE." Computers & Geosciences 28(8): 929-937.
+ Sun, J., (2017). Ground-based GNSS-reflectometry sea level and lake ice thickness measurements (Doctoral dissertation). Retrieved from OhioLINK's ETD Center. (OCLC # 1028024162)



